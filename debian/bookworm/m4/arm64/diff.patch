
Origin: (upstream|backport|vendor|other), (<patch-url>|commit:<commit-id>)
Bug: <upstream-bugtracker-url>
Bug-Debian: https://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: (no|not-needed|<patch-forwarded-url>)
Applied-Upstream: <version>, (<commit-url>|commit:<commid-id>)
Reviewed-By: <name and email of someone who approved/reviewed the patch>
Last-Update: 2025-08-13

--- m4-1.4.19.orig/checks/210.using_froz
+++ m4-1.4.19/checks/210.using_froz
@@ -1,5 +1,5 @@
 dnl @ ../doc/m4.texi:7258: Origin of test
-dnl @ expected status: 1
+dnl @ expected status: 0
 dnl @ extra options:  -F /none/such
 dnl @ Copyright (C) 2006, 2007, 2008, 2009 Free Software
 dnl @ Foundation, Inc.
@@ -8,4 +8,4 @@ dnl @ gives unlimited permission to copy
 dnl @ with or without modifications, as long as this notice
 dnl @ is preserved.
 dnl @ expected error: ignore
-dnl @error{}m4: cannot open `/none/such': No such file or directory
+dnl @error{}m4: warning: cannot open `/none/such': No such file or directory
--- m4-1.4.19.orig/src/freeze.c
+++ m4-1.4.19/src/freeze.c
@@ -110,9 +110,11 @@ produce_frozen_state (const char *name)
 {
   FILE *file;
 
-  file = fopen (name, O_BINARY ? "wbe" : "we");
-  if (!file)
-    m4_failure (errno, _("cannot open `%s'"), name);
+  if (file = fopen (name, O_BINARY ? "wb" : "w"), !file)
+    {
+      m4_failure (errno, _("cannot open `%s'"), name);
+      return;
+    }
 
   /* Write a recognizable header.  */
 
